<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CAVAanalytics">
<title>More about CAVAanalytics â€¢ CAVAanalytics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="More about CAVAanalytics">
<meta property="og:description" content="CAVAanalytics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CAVAanalytics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fas fa fas fa-book"></span>
     
    articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <a class="dropdown-item" href="../articles/Introduction.html">Getting started</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Risk-team/CAVAanalytics/">
    <span class="fa fa fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>More about CAVAanalytics</h1>
            
      
      
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://risk-team.github.io/CAVAanalytics/">CAVAanalytics</a></span><span class="op">)</span></span></code></pre></div>
<p>The main purpose of CAVAanalytics is making the processing and
visualization of multiple climate models simple. Additionally,
CAVAanalytics offers an access point to download CORDEX-CORE climate
models, the high resolution (25 Km) dinamically-downscaled climate
models used in the IPCC report AR5. CAVAanalytics also offers access to
state-of-the-art reanalyses datasets, such as W5E5 and ERA5.</p>
<p>CAVAanalytics is built on top of climate4R and several tidyverse
packages. The current available data that can be downloaded using the
package are:</p>
<ul>
<li>CORDEX-CORE simulations (3 GCMs donwscaled with 3 RCMs for two
RCPs)</li>
<li>W5E5 and ERA5 reanalyses datasets</li>
</ul>
<p>Available variables are:</p>
<ul>
<li>Daily maximum temperature (tasmax)</li>
<li>Daily minimum temperature (tasmin)</li>
<li>Daily precipitation (pr)</li>
<li>Daily relative humidity (hurs)</li>
<li>Daily wind speed (sfcWind)</li>
<li>Daily solar radiation (rsds)</li>
</ul>
<div class="section level2">
<h2 id="loading-cordex-core-data">Loading CORDEX-CORE data<a class="anchor" aria-label="anchor" href="#loading-cordex-core-data"></a>
</h2>
<p>Below we are automatically downloading all CORDEX-CORE simulations
alongside the observational dataset W5E5 for Kenya. As you can see, it
is extremely simple. We will see how to work with locally available
models in another vignette.</p>
<p><strong>Note that this process can take a while, depending on the
size of the country and the number of years specified</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to download a specific area, set country=NULL and specify xlim and ylim arguments</span></span>
<span><span class="va">kenya_exmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_data.html">load_data</a></span><span class="op">(</span>path.to.data <span class="op">=</span> <span class="st">"CORDEX-CORE"</span>, country <span class="op">=</span> <span class="st">"Kenya"</span>, variable <span class="op">=</span> <span class="st">"tasmax"</span>, </span>
<span>years.proj <span class="op">=</span> <span class="fl">2030</span><span class="op">:</span><span class="fl">2055</span>, years.hist <span class="op">=</span> <span class="fl">1980</span><span class="op">:</span><span class="fl">2005</span>, domain <span class="op">=</span> <span class="st">"AFR-22"</span>, path.to.obs <span class="op">=</span> <span class="st">"W5E5"</span><span class="op">)</span></span></code></pre></div>
<p>You can explore the output using attributes(kenya_exmp).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the main output of the loading function is a tibble with list column containing all the downloaded data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "experiment"  "models_mbrs" "obs"</span></span>
<span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">experiment</span></span>
<span><span class="co">#&gt; [1] "historical" "rcp26"      "rcp85"</span></span>
<span></span>
<span><span class="co"># the column models_mbrs stands for model members. The structure of this element comes from the loadeR package. The data is contained in the data element, and as you can see, it has 6 members. CAVAanalytics automatically binds together multiple models and checks for temporal consistency.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">models_mbrs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]    6 9278   42   33</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="projections">Projections<a class="anchor" aria-label="anchor" href="#projections"></a>
</h2>
<p>What if you want to have a look at what will be the projected maximum
temperature in Kenya for the 2030-2055 time period? This is easy to do
with CAVAanalytics:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can specify the season. In this case we are looking at the whole year</span></span>
<span><span class="va">proj_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projections.html">projections</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># stat can take either mean or sd. It is used in combination with ensemble=T. Default is always mean</span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya</span>, ensemble<span class="op">=</span><span class="cn">T</span>, stat<span class="op">=</span><span class="st">"mean"</span>, plot_titles <span class="op">=</span> <span class="st">"mean tasmax"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, stat<span class="op">=</span><span class="st">"mean"</span>, plot_titles <span class="op">=</span> <span class="st">"mean tasmax"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
<p>Sometime looking at mean temperatures is not useful. Maybe we are
interested in understanding the number of days in which certain
conditions are projected to occur. For example, the number of days with
maximum temperatures above 35 Â°C.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">proj_kenya_35</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projections.html">projections</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, uppert<span class="op">=</span><span class="fl">35</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya_35</span>, ensemble<span class="op">=</span><span class="cn">T</span>, plot_titles <span class="op">=</span> <span class="st">"N.days &gt; 35"</span>, palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"darkred"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>Ok, then what about model biases? How can we correct for those?
Again, this is simple to do with CAVAanalytics, because it automatically
implements bias correction with the empirical quantile mapping method.
<strong>Note that the resolution has changed because we have downloaded
the W5E5 dataset which is at 50 Km resolution. To preserve CORDEX-CORE
resolution we need to use ERA5 for bias-correction.</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># bias correction is applied with the widely used empirical quantile method</span></span>
<span><span class="va">proj_kenya_35bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projections.html">projections</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, bias.correction <span class="op">=</span> <span class="cn">T</span>, uppert<span class="op">=</span><span class="fl">35</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya_35bc</span>, ensemble<span class="op">=</span><span class="cn">T</span>,  plot_titles <span class="op">=</span> <span class="st">"N.days &gt; 35 after bc"</span>, palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"darkred"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="climate-change-signal">Climate change signal<a class="anchor" aria-label="anchor" href="#climate-change-signal"></a>
</h2>
<p>While looking at future periods might be useful, sometimes we are
more interested in understanding delta changes, hence the relative
increase or decrease in mean maximum temperatures compared to baseline.
This is also possible with CAVAanalytics:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ccs_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">ccs_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, plot_titles <span class="op">=</span> <span class="st">"Mean tasmax change"</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"cyan"</span>, <span class="st">"green"</span>, <span class="st">"white"</span>, <span class="st">"yellow"</span> ,<span class="st">"orange"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-8-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="trends">Trends<a class="anchor" aria-label="anchor" href="#trends"></a>
</h2>
<p>While looking at delta changes and absolute values for projections is
useful, it does not tell us about temporal trends. In CAVAanalytics, the
function trends allow us to do just that. For example, letâ€™s assume we
want to know whether Kenya is projected to register a significant
increase in yearly maximum temperatures:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the historical argument allows us to study trends for the future or for the past. Note that for historical = T, we need to have specified path.to.obs because this option does not work with the historical experiment of climate models but with observation</span></span>
<span></span>
<span><span class="va">trd_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trends.html">trends</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, historical <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">trd_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, plot_titles <span class="op">=</span> <span class="st">"Â°C/year"</span>, frequencies <span class="op">=</span> <span class="cn">F</span>, spatial_aggr <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-9-1.png" width="960"></p>
<p>While we can visualize the results spatially, we can also look at
temporal trends. Note that in the background, CAVAanalytics uses modern
statistical techniques to draw conclusion on the significance of the
slope parameter.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">trd_kenya</span>, ensemble<span class="op">=</span><span class="cn">T</span>, plot_titles <span class="op">=</span> <span class="st">"Â°C/year"</span>, spatial_aggr <span class="op">=</span> <span class="cn">T</span>, frequencies <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>Rather than performing spatial averages and visualize trends, we can
also appreciate the distribution of annual mean tasmax across Kenya by
specifying frequencies =T</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">trd_kenya</span>, ensemble<span class="op">=</span><span class="cn">T</span>, spatial_aggr <span class="op">=</span> <span class="cn">F</span>, frequencies <span class="op">=</span> <span class="cn">T</span>, n.groups <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-11-1.png" width="960"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Riccardo Soldan, Rodrigo Manzanas, Ana Casanueva.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
