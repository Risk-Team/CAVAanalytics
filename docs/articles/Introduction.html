<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="CAVAanalytics"><title>More about CAVAanalytics • CAVAanalytics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="More about CAVAanalytics"><meta property="og:description" content="CAVAanalytics"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CAVAanalytics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--guides">
    <span class="fas fa fas fa-book"></span>
     
    guides
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--guides">
    <a class="dropdown-item" href="../articles/Introduction.html">start here</a>
    <a class="dropdown-item" href="../articles/more_advanced.html">climate indexes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Risk-team/CAVAanalytics/">
    <span class="fa fa fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>More about CAVAanalytics</h1>
            
      
      
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CAVAanalytics)</span></code></pre></div>
<p>The main purpose of CAVAanalytics is making the processing and
visualization of multiple climate models simple. Additionally,
CAVAanalytics offers an access point to download CORDEX-CORE climate
models, the high resolution (25 Km) dinamically-downscaled climate
models used in the IPCC report AR5. CAVAanalytics also offers access to
state-of-the-art reanalyses datasets, such as W5E5 and ERA5.</p>
<p>CAVAanalytics is built on top of climate4R and several tidyverse
packages. The current available data that can be downloaded using the
package are:</p>
<ul>
<li>CORDEX-CORE simulations (3 GCMs donwscaled with 2 RCMs for two
RCPs)</li>
<li>W5E5 and ERA5 reanalyses datasets</li>
</ul>
<p>Available variables are:</p>
<ul>
<li>Daily maximum temperature (tasmax)</li>
<li>Daily minimum temperature (tasmin)</li>
<li>Daily mean temperature (tas)</li>
<li>Daily precipitation (pr)</li>
<li>Daily relative humidity (hurs)</li>
<li>Daily wind speed (sfcWind)</li>
<li>Daily solar radiation (rsds)</li>
</ul>
<div id="loading-cordex-core-data" class="section level2">
<h2>Loading CORDEX-CORE data</h2>
<p>Below we are automatically downloading all CORDEX-CORE simulations
alongside the observational dataset ERA5 for Kenya. As you can see, it
is extremely simple. We will see how to work with locally available
models in another vignette.<br />
<strong>Note that this process can take a while, depending on the size
of the country and the number of years specified</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to download a specific area, set country=NULL and specify xlim and ylim arguments. </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>kenya_exmp <span class="ot">&lt;-</span> <span class="fu">load_data</span>(<span class="at">path.to.data =</span> <span class="st">&quot;CORDEX-CORE&quot;</span>, <span class="at">country =</span> <span class="st">&quot;Kenya&quot;</span>, <span class="at">variable =</span> <span class="st">&quot;tasmax&quot;</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">years.proj =</span> <span class="dv">2030</span><span class="sc">:</span><span class="dv">2055</span>, <span class="at">years.hist =</span> <span class="dv">1980</span><span class="sc">:</span><span class="dv">2005</span>, <span class="at">domain =</span> <span class="st">&quot;AFR-22&quot;</span>, <span class="at">path.to.obs =</span> <span class="st">&quot;ERA5&quot;</span>)</span></code></pre></div>
<p>You can explore the output using attributes(kenya_exmp).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the main output of the loading function is a tibble with list column containing all the downloaded data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(kenya_exmp[[<span class="dv">1</span>]])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(kenya_exmp[[<span class="dv">1</span>]])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;experiment&quot;  &quot;models_mbrs&quot; &quot;obs&quot;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>kenya_exmp[[<span class="dv">1</span>]]<span class="sc">$</span>experiment</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;historical&quot; &quot;rcp26&quot;      &quot;rcp85&quot;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the column models_mbrs stands for model members. The structure of this element comes from the loadeR package. The data is contained in the data element, and as you can see, it has 6 members. CAVAanalytics automatically binds together multiple models and checks for temporal consistency.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(kenya_exmp[[<span class="dv">1</span>]]<span class="sc">$</span>models_mbrs[[<span class="dv">1</span>]]<span class="sc">$</span>Data)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]    6 9278   42   33</span></span></code></pre></div>
<p>When uploading CORDEX-CORE data it is important to understand the
concept of CORDEX domains. The domain argument in load_data needs to be
correctly specified. Below is an example of the available CORDEX
domains.</p>
<p><img src="/home/riccardo/Dropbox/RIKI/FAO/tools/CAVAanalytics/vignettes/domains.png" id="fig:figure-1" /></p>
</div>
<div id="observations" class="section level2">
<h2>Observations</h2>
<p>We can examine historical data using the loaded observational
dataset, which, in this case, is ERA5. In this case, we are looking at
the mean historical maximum temperature for the whole year.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>kenya_obs <span class="ot">&lt;-</span> <span class="fu">observations</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(kenya_obs, <span class="at">plot_titles =</span> <span class="st">&quot;Mean tasmax&quot;</span>)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;" />
If you want, you can also use pre-defined IPCC color palettes. You can
type ?IPCC_palette for more info</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(kenya_obs, <span class="at">plot_titles =</span> <span class="st">&quot;Mean tasmax&quot;</span>, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">palette =</span> <span class="fu">IPCC_palette</span>(<span class="at">type =</span> <span class="st">&quot;tmp&quot;</span>, <span class="at">divergent =</span> F))</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>How many days above 35 °C occurred on average?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>kenya_obs<span class="fl">.35</span> <span class="ot">&lt;-</span> <span class="fu">observations</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>), <span class="at">uppert=</span><span class="dv">35</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(kenya_obs<span class="fl">.35</span>, <span class="at">plot_titles =</span> <span class="st">&quot;N.days &gt; 35&quot;</span>)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>You can also specify more than one season at a time</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>kenya_obs<span class="fl">.35</span> <span class="ot">&lt;-</span> <span class="fu">observations</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>), <span class="at">uppert=</span><span class="dv">35</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(kenya_obs<span class="fl">.35</span>, <span class="at">plot_titles =</span> <span class="st">&quot;N.days &gt; 35&quot;</span>)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-7-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="model-biases" class="section level2">
<h2>Model biases</h2>
<p>Before diving into the analyses of climate model projections, it is
essential to examine model biases. Defining biases can be somewhat
arbitrary as it depends on the specific and intended usage of climate
models. However, CAVAanalytics offers a flexible and straightforward
approach to conducting this analysis. Let’s begin by exploring the
differences in mean climatology between the CORDEX-CORE historical
experiments and ERA5.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># you can specify the season. In this case we are looking at the whole year</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>biases_kenya <span class="ot">&lt;-</span> <span class="fu">model_biases</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(biases_kenya, <span class="at">ensemble=</span>F, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">trends=</span>F, <span class="at">plot_titles =</span> <span class="st">&quot;mean tasmax biases&quot;</span>, <span class="at">palette =</span> <span class="fu">IPCC_palette</span>(<span class="at">type=</span><span class="st">&quot;tmp&quot;</span>, <span class="at">divergent =</span> T))</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-8-1.png" width="960" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(biases_kenya, <span class="at">ensemble=</span>F, <span class="at">trends=</span>T, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="at">plot_titles =</span> <span class="st">&quot;mean tasmax biases&quot;</span>)<span class="sc">+</span>ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Before bias correction&quot;</span>)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-9-1.png" width="960" />
As we can see, the biases are mainly positive, hence CORDEX-CORE models
are warmer than the “observed” data. However, what happens if we bias
correct the data? The results look much better now and mean biases are
reduced thanks to bias correction.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>biases_kenya.bs <span class="ot">&lt;-</span> <span class="fu">model_biases</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>), <span class="at">bias.correction =</span> T)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(biases_kenya.bs, <span class="at">ensemble=</span>F, <span class="at">trends=</span>T, <span class="at">plot_titles =</span> <span class="st">&quot;mean tasmax biases&quot;</span>)<span class="sc">+</span>ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;After bias correction&quot;</span>)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
</div>
<div id="projections" class="section level2">
<h2>Projections</h2>
<p>Now that we looked at model biases, we can start exploring future
projections. For example, what if you want to have a look at what will
be the projected maximum temperature in Kenya for the 2030-2055 time
period? <strong>Let’s remember that these models have positive biases
though.</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># you can specify the season. In this case we are looking at the whole year</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>proj_kenya <span class="ot">&lt;-</span> <span class="fu">projections</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stat can take either mean or sd. It is used in combination with ensemble=T. Default is always mean</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(proj_kenya, <span class="at">ensemble=</span>T, <span class="at">stat=</span><span class="st">&quot;mean&quot;</span>, <span class="at">plot_titles =</span> <span class="st">&quot;mean tasmax&quot;</span>)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-11-1.png" width="288" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(proj_kenya, <span class="at">ensemble=</span>F, <span class="at">stat=</span><span class="st">&quot;mean&quot;</span>, <span class="at">plot_titles =</span> <span class="st">&quot;mean tasmax&quot;</span>)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-12-1.png" width="960" /></p>
<p>In certain cases, focusing solely on mean temperatures might not
provide the insights we need. Instead, we might be interested in
understanding the frequency of specific conditions projected to occur.
For instance, we may want to determine the number of days with maximum
temperatures above 35 °C.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>proj_kenya_35 <span class="ot">&lt;-</span> <span class="fu">projections</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>), <span class="at">uppert=</span><span class="dv">35</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(proj_kenya_35, <span class="at">ensemble=</span>T, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="at">plot_titles =</span> <span class="st">&quot;N &gt; 35&quot;</span>, <span class="at">palette=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkred&quot;</span>))</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>When dealing with model biases, CAVAanalytics offers a
straightforward solution by automatically implementing bias correction
using the empirical quantile mapping method. This process allows us to
correct for discrepancies between observed data and model outputs.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bias correction is applied with the widely used empirical quantile method</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>proj_kenya_35bc <span class="ot">&lt;-</span> <span class="fu">projections</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>), <span class="at">bias.correction =</span> T, <span class="at">uppert=</span><span class="dv">35</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(proj_kenya_35bc, <span class="at">ensemble=</span>T,  </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">plot_titles =</span> <span class="st">&quot;N &gt; 35 bc&quot;</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="at">palette=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkred&quot;</span>), <span class="at">legend_range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">320</span>))</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-14-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="climate-change-signal" class="section level2">
<h2>Climate change signal</h2>
<p>While analyzing future periods can be beneficial, there are instances
where we prioritize understanding delta changes, which represent the
relative increase or decrease in mean maximum temperatures compared to a
baseline. CAVAanalytics facilitates this analysis as well.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ccs_kenya <span class="ot">&lt;-</span> <span class="fu">climate_change_signal</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(ccs_kenya, <span class="at">ensemble=</span>F, <span class="at">plot_titles =</span> <span class="st">&quot;Mean tasmax change&quot;</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">legend_range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;yellow&quot;</span> ,<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-15-1.png" width="960" /></p>
</div>
<div id="trends" class="section level2">
<h2>Trends</h2>
<p>While examining delta changes and absolute values for projections
provides valuable information, it may not offer insights into temporal
trends. However, using the ‘trends’ function in CAVAanalytics allows us
to address this limitation. For instance, we can determine if Kenya has
experienced or is projected to experience a noteworthy rise in yearly
maximum temperatures.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the observation argument allows us to study trends for the future or for the past. Note that for observation = T, we need to have specified path.to.obs because this option does not work with the historical experiment of climate models but with observation</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>trd_kenya.obs <span class="ot">&lt;-</span> <span class="fu">trends</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>),<span class="at">observation =</span> T)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(trd_kenya.obs, <span class="at">plot_titles =</span> <span class="st">&quot;°C/year&quot;</span>, <span class="at">frequencies =</span> F, <span class="at">spatial_aggr =</span> F)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-16-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>We can look at trend for the future period as well by changing the
observation argument to FALSE</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>trd_kenya.prj <span class="ot">&lt;-</span> <span class="fu">trends</span>(kenya_exmp, <span class="at">season=</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>),<span class="at">observation =</span> F)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(trd_kenya.prj, <span class="at">ensemble=</span>F, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="at">plot_titles =</span> <span class="st">&quot;°C/year&quot;</span>, <span class="at">frequencies =</span> F, <span class="at">spatial_aggr =</span> F)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-17-1.png" width="960" /></p>
<p>Another feature of the trends function is that you can look at the
global significance of the ensemble. The plot below shows you the number
of models that agrees in a certain change (increase or decrease) while
the global p.value is calculated based on the <a
href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/j.2041-210X.2012.00190.x">manylm
function of mvabund</a>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(trd_kenya.prj, <span class="at">ensemble=</span>T, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="at">plot_titles =</span> <span class="st">&quot;N. memb&quot;</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="at">frequencies =</span> F, <span class="at">spatial_aggr =</span> F, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-18-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>While we can visualize the results spatially, we can also look at
temporal trends. In this case, a general additive model using a cubic
regression spline is applied to better capture non-linear patterns.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(trd_kenya.prj, <span class="at">ensemble=</span>T, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="at">plot_titles =</span> <span class="st">&quot;°C&quot;</span>, <span class="at">spatial_aggr =</span> T, <span class="at">frequencies =</span> F)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-19-1.png" width="576" /></p>
<p>In addition to performing spatial averages and visualizing trends, we
can gain valuable insights by examining the distribution of annual mean
tasmax (maximum temperature) across Kenya using the specified
frequencies, denoted as ‘TRUE.’ This approach is particularly valuable
because many analyses tend to aggregate data either spatially or
temporally, potentially obscuring certain patterns. By utilizing the
‘frequencies=T’ option, we ensure a comprehensive understanding of both
spatial and temporal attributes, allowing us to uncover hidden patterns
in the data.”</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(trd_kenya.prj, <span class="at">ensemble=</span>T, <span class="at">spatial_aggr =</span> F, <span class="at">plot_titles =</span> <span class="st">&quot;°C&quot;</span>, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="at">frequencies =</span> T, <span class="at">n.groups =</span> <span class="dv">2</span>,<span class="at">palette=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-20-1.png" width="576" /></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Riccardo Soldan, Rodrigo Manzanas, Ana Casanueva.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>
