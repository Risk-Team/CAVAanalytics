<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction • CAVAanalytics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="CAVAanalytics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CAVAanalytics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Introduction_files/header-attrs-2.17/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
            
      
      
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CAVAanalytics</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: loadeR.java</span>
<span class="co">#&gt; Loading required package: rJava</span>
<span class="co">#&gt; Java version 11x amd64 by Oracle Corporation detected</span>
<span class="co">#&gt; NetCDF Java Library v4.6.0-SNAPSHOT (23 Apr 2015) loaded and ready</span></code></pre></div>
<div id="more-info-about-cavaanalytics" class="section level2">
<h2 class="hasAnchor">
<a href="#more-info-about-cavaanalytics" class="anchor"></a>More info about CAVAanalytics</h2>
<p>The main purpose of CAVAanalytics is making the processing and
visualization of multiple climate models simple. Additionally,
CAVAanalytics offers an access point to download CORDEX-CORE climate
models, the high resolution (25 Km) dinamically-downscaled climate
models used in the IPCC report AR5. CAVAanalytics also offers access to
state-of-the-art reanalyses datasets, such as W5E5 and ERA5.</p>
<p>CAVAanalytics is built on top of climate4R and several tidyverse
packages. The current available data that can be downloaded using the
package are:</p>
<ul>
<li>CORDEX-CORE simulations (3 GCMs donwscaled with 3 RCMs for two
RCPs)</li>
<li>W5E5 and ERA5 reanalyses datasets</li>
</ul>
<p>Available variables are:</p>
<ul>
<li>Daily maximum temperature (tasmax)</li>
<li>Daily minimum temperature (tasmin)</li>
<li>Daily precipitation (pr)</li>
<li>Daily relative humidity (hurs)</li>
<li>Daily wind speed (sfcWind)</li>
<li>Daily solar radiation (rsds)</li>
</ul>
</div>
<div id="loading-cordex-core-data" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-cordex-core-data" class="anchor"></a>Loading CORDEX-CORE data</h2>
<p>Below we are automatically downloading all CORDEX-CORE simulations
alongside the observational dataset W5E5 for Kenya. As you can see, it
is extremely simple. We will see how to work with locally available
models in another vignette.</p>
<p><strong>Note that this process can take a while, depending on the
size of the country and the number of years specified</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to download a specific area, set country=NULL and specify xlim and ylim arguments</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>kenya_exmp <span class="ot">&lt;-</span> <span class="fu">load_data</span>(<span class="at">path.to.data =</span> <span class="st">"CORDEX-CORE"</span>, <span class="at">country =</span> <span class="st">"Kenya"</span>, <span class="at">variable =</span> <span class="st">"tasmax"</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">years.proj =</span> <span class="dv">2030</span><span class="sc">:</span><span class="dv">2055</span>, <span class="at">years.hist =</span> <span class="dv">1980</span><span class="sc">:</span><span class="dv">2005</span>, <span class="at">domain =</span> <span class="st">"AFR-22"</span>, <span class="at">path.to.obs =</span> <span class="st">"W5E5"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Accessing inventory</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ Accessing inventory [3.5s]</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Downloading CORDEX-CORE data (18 simulations). This might take a while. Using…</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ Downloading CORDEX-CORE data (18 simulations). This might take a while. Using…</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Downloaded 1.82 GB</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Binding members and checking temporal consistency</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Downloading W5E5</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ Downloading W5E5 [6m 18s]</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Binding members and checking temporal consistency</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>✔ Binding members and checking temporal consistency [6m <span class="fl">32.9</span>s]</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Temperature has been converted into Celsius</span></span></code></pre></div>
<p>You can explore the output using attributes(kenya_exmp).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the main output of the loading function is a tibble with list column containing all the downloaded data</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "experiment"  "models_mbrs" "obs"</span>
<span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">experiment</span>
<span class="co">#&gt; [1] "historical" "rcp26"      "rcp85"</span>

<span class="co"># the column models_mbrs stands for model members. The structure of this element comes from the loadeR package. The data is contained in the data element, and as you can see, it has 6 members. CAVAanalytics automatically binds together multiple models and checks for temporal consistency.</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">models_mbrs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>
<span class="co">#&gt; [1]    6 9278   40   33</span></code></pre></div>
</div>
<div id="projections" class="section level2">
<h2 class="hasAnchor">
<a href="#projections" class="anchor"></a>Projections</h2>
<p>What if you want to have a look at what will be the projected maximum
temperature in Kenya for the 2030-2055 time period? This is easy to do
with CAVAanalytics:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># you can specify the season. In this case we are looking at the whole year</span>
<span class="va">proj_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projections.html">projections</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>
<span class="co">#&gt; ℹ  projections, season 1-2-3-4-5-6-7-8-9-10-11-12. Calculation of mean  tasmax</span>
<span class="co">#&gt; ℹ Performing calculations</span>
<span class="co">#&gt; ✔ Performing calculations [6.4s]</span>
<span class="co">#&gt; </span>

<span class="co"># stat can take either mean or sd. It is used in combination with ensemble=T. Default is always mean</span>
<span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya</span>, ensemble<span class="op">=</span><span class="cn">T</span>, stat<span class="op">=</span><span class="st">"mean"</span>, plot_titles <span class="op">=</span> <span class="st">"mean tasmax"</span><span class="op">)</span>
<span class="co">#&gt; ℹ Visualizing ensemble mean</span>
<span class="co">#&gt; ℹ Plotting</span>
<span class="co">#&gt; ✔ Plotting [31ms]</span>
<span class="co">#&gt; </span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, stat<span class="op">=</span><span class="st">"mean"</span>, plot_titles <span class="op">=</span> <span class="st">"mean tasmax"</span><span class="op">)</span>
<span class="co">#&gt; ℹ Visualizing individual members, argument stat is ignored</span>
<span class="co">#&gt; ℹ Plotting</span>
<span class="co">#&gt; ✔ Plotting [38ms]</span>
<span class="co">#&gt; </span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
<p>Sometime looking at mean temperatures is not useful. Maybe we are
interested in understanding the number of days in which certain
conditions are projected to occur. For example, the number of days with
maximum temperatures above 35 °C.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">proj_kenya_35</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projections.html">projections</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, uppert<span class="op">=</span><span class="fl">35</span><span class="op">)</span>
<span class="co">#&gt; ℹ  projections, season 1-2-3-4-5-6-7-8-9-10-11-12. Calculation of number of days with tasmax above threshold of 35</span>
<span class="co">#&gt; ℹ Performing calculations</span>
<span class="co">#&gt; ✔ Performing calculations [5.4s]</span>
<span class="co">#&gt; </span>

<span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya_35</span>, ensemble<span class="op">=</span><span class="cn">T</span>, plot_titles <span class="op">=</span> <span class="st">"N.days &gt; 35"</span>, palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"darkred"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ℹ Visualizing ensemble mean</span>
<span class="co">#&gt; ℹ Plotting</span>
<span class="co">#&gt; ✔ Plotting [14ms]</span>
<span class="co">#&gt; </span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-6-1.png" width="576">
Ok, then what about model biases? How can we correct for those? Again,
this is simple to do with CAVAanalytics:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bias correction is applied with the widely used empirical quantile method</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>proj_kenya_35bc <span class="ot">&lt;-</span> <span class="fu">projections</span>(kenya_exmp, <span class="at">season=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">bias.correction =</span> T, <span class="at">uppert=</span><span class="dv">35</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ  projections, season 1-2-3-4-5-6-7-8-9-10-11-12. Calculation of number of days with tasmax above threshold of 35 after bias-correction</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Performing calculations</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ  Performing monthly bias correction with the empirical quantile mapping  method, for each model and month separately. This can take a while. Season 1-2-3-4-5-6-7-8-9-10-11-12</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Performing calculations</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a> ■■■■■■■■■■■■■■■■                  <span class="dv">50</span>% <span class="sc">|</span>  ETA<span class="sc">:</span> 48s</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Performing calculations</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>✔ Performing calculations [1m <span class="fl">37.6</span>s]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plotting</span>(proj_kenya_35bc, <span class="at">ensemble=</span>T,  <span class="at">plot_titles =</span> <span class="st">"N.days &gt; 35 after bc"</span>, <span class="at">palette=</span><span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"darkred"</span>))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Visualizing ensemble mean</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Plotting</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✔ Plotting [13ms]</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-7-1.png" width="576">
As you can see, we lost resolution and that is because the W5E5 dataset
is at 50 Km. To preserve the CORDEX-CORE native resolution after
bias-correction we would need to use the ERA5 dataset.</p>
</div>
<div id="climate-change-signal" class="section level2">
<h2 class="hasAnchor">
<a href="#climate-change-signal" class="anchor"></a>Climate change signal</h2>
<p>While looking at future periods might be useful, sometimes we are
more interested in understanding delta changes, hence the relative
increase or decrease in mean maximum temperatures compared to baseline.
This is also possible with CAVAanalytics:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">ccs_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>
<span class="co">#&gt; ℹ  climate change signal, season 1-2-3-4-5-6-7-8-9-10-11-12. Climate change signal for mean tasmax</span>
<span class="co">#&gt; ℹ Performing calculations</span>
<span class="co">#&gt; ✔ Performing calculations [7.5s]</span>
<span class="co">#&gt; </span>

<span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">ccs_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, plot_titles <span class="op">=</span> <span class="st">"Mean tasmax change"</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"cyan"</span>, <span class="st">"green"</span>, <span class="st">"white"</span>, <span class="st">"yellow"</span> ,<span class="st">"orange"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ℹ  Visualizing individual members, argument stat is ignored</span>
<span class="co">#&gt; ℹ Plotting</span>
<span class="co">#&gt; ✔ Plotting [49ms]</span>
<span class="co">#&gt; </span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-8-1.png" width="960"></p>
</div>
<div id="trends" class="section level2">
<h2 class="hasAnchor">
<a href="#trends" class="anchor"></a>Trends</h2>
<p>While looking at delta changes and absolute values for projections is
useful, it does not tell us about temporal trends. In CAVAanalytics, the
function trends allow us to do just that. For example, let’s assume we
want to know whether Kenya is projected to register a significant
increase in yearly maximum temperatures:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the historical argument allows us to study trends for the future or for the past. Note that for historical = T, we need to have specified path.to.obs because this option does not work with the historical experiment of climate models but with observation</span>

<span class="va">trd_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trends.html">trends</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, historical <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="co">#&gt; ℹ  trends, projections, season 1-2-3-4-5-6-7-8-9-10-11-12. Calculation of yearly increase in mean  tasmax</span>
<span class="co">#&gt; ℹ Processing rcp26</span>
<span class="co">#&gt; ℹ Applying multivariate linear regression to the ensemble. Global test statisti…</span>
<span class="co">#&gt; ✔ Applying multivariate linear regression to the ensemble. Global test statisti…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ℹ Processing rcp85</span>
<span class="co">#&gt; ℹ Applying multivariate linear regression to the ensemble. Global test statisti…</span>
<span class="co">#&gt; ✔ Applying multivariate linear regression to the ensemble. Global test statisti…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ℹ  Processing rcp26</span>
<span class="co">#&gt; ℹ Applying linear regression to each ensemble member. P-value calculated using …</span>
<span class="co">#&gt; ✔ Applying linear regression to each ensemble member. P-value calculated using …</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ℹ  Processing rcp85</span>
<span class="co">#&gt; ℹ Applying linear regression to each ensemble member. P-value calculated using …</span>
<span class="co">#&gt; ✔ Applying linear regression to each ensemble member. P-value calculated using …</span>
<span class="co">#&gt; </span>

<span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">trd_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, plot_titles <span class="op">=</span> <span class="st">"°C/year"</span>, frequencies <span class="op">=</span> <span class="cn">F</span>, spatial_aggr <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="co">#&gt; ℹ  Visualizing individual members</span>
<span class="co">#&gt; ℹ Plotting</span>
<span class="co">#&gt; ✔ Plotting [1ms]</span>
<span class="co">#&gt; </span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-9-1.png" width="960"></p>
<p>While we can visualize the results spatially, we can also look at
temporal trends. Note that in the background, CAVAanalytics uses modern
statistical techniques to draw conclusion on the significance of the
slope parameter.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">trd_kenya</span>, ensemble<span class="op">=</span><span class="cn">T</span>, plot_titles <span class="op">=</span> <span class="st">"°C/year"</span>, spatial_aggr <span class="op">=</span> <span class="cn">T</span>, frequencies <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="co">#&gt; !  Arguments bins and legend_range are ignored</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>Rather than performing spatial averages and visualize trends, we can
also appreciate the distribution of annual mean tasmax across Kenya by
specifying frequencies =T</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">trd_kenya</span>, ensemble<span class="op">=</span><span class="cn">T</span>, spatial_aggr <span class="op">=</span> <span class="cn">F</span>, frequencies <span class="op">=</span> <span class="cn">T</span>, n.groups <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; !  Arguments bins, legend_range, plot_titles and palette are ignored. Change number of group intervals with n.groups</span>
<span class="co">#&gt; Picking joint bandwidth of 0.403</span>
<span class="co">#&gt; Picking joint bandwidth of 0.402</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-11-1.png" width="960"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Riccardo Soldan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
