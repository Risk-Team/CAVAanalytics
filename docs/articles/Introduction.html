<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>More about CAVAanalytics • CAVAanalytics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="More about CAVAanalytics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CAVAanalytics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/CAVA.html"><span class="fa fas fa-cloud-sun-rain"></span> CAVA vs other tools</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/more_advanced.html">Climate indexes</a></li>
    <li><a class="dropdown-item" href="../articles/large_areas.html">Computation over large regions</a></li>
    <li><a class="dropdown-item" href="../articles/own_data.html">CAVAanalytics and CMIP6 models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Risk-team/CAVAanalytics/"><span class="fa fa-github fa-lg"></span> GitHub</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fas fa-history"></span> Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>More about CAVAanalytics</h1>
            
      

      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://risk-team.github.io/CAVAanalytics/">CAVAanalytics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>The main purpose of CAVAanalytics is making the processing and
visualization of multiple climate and impact models simple.
CAVAanalytics offers an access point to download CORDEX-CORE climate
models, the high resolution (25 Km) dinamically-downscaled climate
models used in the IPCC report AR5. CAVAanalytics also offers access to
state-of-the-art reanalyses datasets, such as W5E5 and ERA5.</p>
<p>CAVAanalytics is built on top of climate4R and several tidyverse
packages. The current available data that can be downloaded using the
package are:</p>
<div class="section level3">
<h3 id="climate-module">Climate module<a class="anchor" aria-label="anchor" href="#climate-module"></a>
</h3>
<ul>
<li>CORDEX-CORE simulations (3 GCMs donwscaled with 2 RCMs for two
RCPs)</li>
<li>W5E5 and ERA5 reanalyses datasets</li>
</ul>
<p>Available variables are:</p>
<ul>
<li>Daily maximum temperature (tasmax)</li>
<li>Daily minimum temperature (tasmin)</li>
<li>Daily mean temperature (tas)</li>
<li>Daily precipitation (pr)</li>
<li>Daily relative humidity (hurs)</li>
<li>Daily wind speed (sfcWind)</li>
<li>Daily solar radiation (rsds)</li>
</ul>
</div>
<div class="section level3">
<h3 id="agriculture-module">Agriculture module<a class="anchor" aria-label="anchor" href="#agriculture-module"></a>
</h3>
<p>ISIMIP3 impact models will become available in the close future</p>
</div>
<div class="section level2">
<h2 id="loading-cordex-core-data">Loading CORDEX-CORE data<a class="anchor" aria-label="anchor" href="#loading-cordex-core-data"></a>
</h2>
<p>Below we are automatically downloading all CORDEX-CORE simulations
alongside the observational dataset ERA5 for Kenya. As you can see, it
is very simple. We will see how to work with locally available models in
another vignette.<br><strong>Note that this process can take a while, depending on the size
of the country and the number of years specified</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to download a specific area, set country=NULL and specify xlim and ylim arguments. </span></span>
<span><span class="va">kenya_exmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_data.html">load_data</a></span><span class="op">(</span>path.to.data <span class="op">=</span> <span class="st">"CORDEX-CORE"</span>, country <span class="op">=</span> <span class="st">"Kenya"</span>, variable <span class="op">=</span> <span class="st">"tasmax"</span>, </span>
<span>years.proj <span class="op">=</span> <span class="fl">2030</span><span class="op">:</span><span class="fl">2055</span>, years.hist <span class="op">=</span> <span class="fl">1980</span><span class="op">:</span><span class="fl">2005</span>, domain <span class="op">=</span> <span class="st">"AFR-22"</span>, path.to.obs <span class="op">=</span> <span class="st">"ERA5"</span><span class="op">)</span></span></code></pre></div>
<p>You can explore the output using attributes(kenya_exmp).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the main output of the loading function is a tibble with list column containing all the downloaded data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "experiment"  "models_mbrs" "obs"</span></span>
<span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">experiment</span></span>
<span><span class="co">#&gt; [1] "historical" "rcp26"      "rcp85"</span></span>
<span><span class="co"># the column models_mbrs stands for model members. The structure of this element comes from the loadeR package. The data is contained in the data element, and as you can see, it has 6 members. CAVAanalytics automatically binds together multiple models and checks for temporal consistency.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">kenya_exmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">models_mbrs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]    6 9278   42   33</span></span></code></pre></div>
<p>When uploading CORDEX-CORE data it is important to understand the
concept of CORDEX domains. The domain argument in load_data needs to be
correctly specified.</p>
</div>
<div class="section level2">
<h2 id="observations">Observations<a class="anchor" aria-label="anchor" href="#observations"></a>
</h2>
<p>We can examine historical data using the loaded observational
dataset, which, in this case, is ERA5. In this case, we are looking at
the mean historical maximum temperature for the whole year.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kenya_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observations.html">observations</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">kenya_obs</span>, plot_titles <span class="op">=</span> <span class="st">"°C"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;">
If you want, you can also use pre-defined IPCC color palettes. You can
type ?IPCC_palette for more info</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">kenya_obs</span>, plot_titles <span class="op">=</span> <span class="st">"°C"</span>, </span>
<span>palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;"></p>
<p>How many days above 35 °C occurred on average?</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kenya_obs.35</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observations.html">observations</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, uppert<span class="op">=</span><span class="fl">35</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">kenya_obs.35</span>, plot_titles <span class="op">=</span> <span class="st">"Days &gt; 35 °C"</span>,  palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;"></p>
<p>You can also specify more than one season at a time</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/observations.html">observations</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, uppert<span class="op">=</span><span class="fl">35</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">.</span>, plot_titles <span class="op">=</span> <span class="st">"Days &gt; 35 °C"</span>, palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>You can also visualize the results as a temporal trend</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/observations.html">observations</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, uppert<span class="op">=</span><span class="fl">35</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">.</span>, plot_titles <span class="op">=</span> <span class="st">"N.days &gt; 35 °C"</span>, temporal<span class="op">=</span><span class="cn">T</span>, palette<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
<p>And we can apply linear regression to each pixel to assess the
statistical significance of the yearly increase in the number of days
with Tmax higher than 35 degrees Celsius.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/observations.html">observations</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, uppert<span class="op">=</span><span class="fl">35</span>,trends<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">.</span>, plot_titles <span class="op">=</span> <span class="st">"Days/year"</span>, palette<span class="op">=</span><span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="model-biases">Model biases<a class="anchor" aria-label="anchor" href="#model-biases"></a>
</h2>
<p>Before diving into the analyses of climate model projections, it is
essential to examine model biases. CAVAanalytics offers a flexible and
straightforward approach to conducting this analysis. Let’s begin by
exploring the differences in mean climatology between the CORDEX-CORE
historical experiments and ERA5.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can specify the season. In this case we are looking at the whole year</span></span>
<span><span class="va">biases_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_biases.html">model_biases</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span><span class="op">=</span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">biases_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, temporal<span class="op">=</span><span class="cn">T</span>, </span>
<span>plot_titles <span class="op">=</span> <span class="st">"Biases in °C"</span><span class="op">)</span><span class="op">+</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Before bias correction"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span><span class="op">=</span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">biases_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, </span>
<span>temporal<span class="op">=</span><span class="cn">F</span>, plot_titles <span class="op">=</span> <span class="st">"Biases in °C"</span>, palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">a</span><span class="op">/</span><span class="va">b</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
<p>As we can see, the biases are mainly positive, hence CORDEX-CORE
models are warmer than the “observed” data. However, what happens if we
bias correct the data? The results look much better now and mean biases
are reduced thanks to bias correction. Bias correction is applied with
the <a href="https://rdrr.io/github/SantanderMetGroup/downscaleR/man/biasCorrection.html" class="external-link">Empirical
Quantile Mapping (eqm) method as default but Quantile Delta Mapping
(qdm) or scaling</a> can also be used. Cross-validation is used to avoid
overfitting.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bs_scaling</span><span class="op">=</span><span class="fu"><a href="../reference/model_biases.html">model_biases</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, bias.correction <span class="op">=</span> <span class="cn">T</span>, method<span class="op">=</span><span class="st">"scaling"</span>, cross_validation <span class="op">=</span> <span class="st">"3fold"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span><span class="op">=</span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">bs_scaling</span>, ensemble<span class="op">=</span><span class="cn">F</span>, temporal<span class="op">=</span><span class="cn">T</span>, plot_titles <span class="op">=</span> <span class="st">"Biases in °C"</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">1.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"After bias correction-scaling method"</span><span class="op">)</span></span>
<span><span class="va">b</span><span class="op">=</span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">bs_scaling</span>, plot_titles <span class="op">=</span>  <span class="st">"Biases in °C"</span>,legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.09</span>,<span class="fl">0.09</span><span class="op">)</span>, ensemble <span class="op">=</span> <span class="cn">F</span> ,palette<span class="op">=</span><span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span><span class="op">/</span><span class="va">b</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-11-1.png" width="960"></p>
<p>If we want to explore model biases biases on, let’s say, the number
of very warm days (days with maximum temperature above 35 °C), then the
choice of the bias-correction method is very important. Empirical
quantile methods are much more suitable in this case because they
correct the data distribution.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">bias.scaling</span><span class="op">=</span><span class="fu"><a href="../reference/model_biases.html">model_biases</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, uppert<span class="op">=</span><span class="fl">35</span>, bias.correction <span class="op">=</span> <span class="cn">T</span>, method<span class="op">=</span><span class="st">"scaling"</span>, cross_validation <span class="op">=</span> <span class="st">"3fold"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span><span class="op">=</span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">bias.scaling</span>, ensemble<span class="op">=</span><span class="cn">F</span>,  legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">40</span>,<span class="fl">40</span><span class="op">)</span>, palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, plot_titles <span class="op">=</span> <span class="st">"Biases in N° days"</span><span class="op">)</span><span class="op">+</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"After bias correction-scaling method"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bias.eqm</span><span class="op">=</span><span class="fu"><a href="../reference/model_biases.html">model_biases</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, uppert<span class="op">=</span><span class="fl">35</span>, bias.correction <span class="op">=</span> <span class="cn">T</span>, method<span class="op">=</span><span class="st">"eqm"</span>, cross_validation <span class="op">=</span> <span class="st">"3fold"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span><span class="op">=</span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">bias.eqm</span>, ensemble<span class="op">=</span><span class="cn">F</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">40</span>,<span class="fl">40</span><span class="op">)</span>, palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, plot_titles <span class="op">=</span> <span class="st">"Biases in N° days"</span><span class="op">)</span><span class="op">+</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"After bias correction-eqm method"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span><span class="op">/</span><span class="va">b</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="projections">Projections<a class="anchor" aria-label="anchor" href="#projections"></a>
</h2>
<p>Now that we looked at model biases, we can start exploring future
projections. For example, what if you want to have a look at what will
be the projected maximum temperature in Kenya for the 2030-2055 time
period? <strong>Let’s remember that these models have positive biases
though.</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can specify the season. In this case we are looking at the whole year</span></span>
<span><span class="va">proj_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projections.html">projections</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># stat can take either mean or sd. It is used in combination with ensemble=T. Default is always mean</span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya</span>, ensemble<span class="op">=</span><span class="cn">T</span>, stat<span class="op">=</span><span class="st">"mean"</span>, plot_titles <span class="op">=</span> <span class="st">"mean tasmax"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-13-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, stat<span class="op">=</span><span class="st">"mean"</span>, plot_titles <span class="op">=</span> <span class="st">"mean tasmax"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-14-1.png" width="960"></p>
<p>In certain cases, focusing solely on mean temperatures might not
provide the insights we need. Instead, we might be interested in
understanding the frequency of specific conditions projected to occur.
For instance, we may want to determine the number of days with maximum
temperatures above 35 °C.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proj_kenya_35</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projections.html">projections</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, uppert<span class="op">=</span><span class="fl">35</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya_35</span>, ensemble<span class="op">=</span><span class="cn">T</span>,  legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>plot_titles <span class="op">=</span> <span class="st">"N &gt; 35"</span>, palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"darkred"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-15-1.png" width="480" style="display: block; margin: auto;"></p>
<p>When dealing with model biases, CAVAanalytics offers a
straightforward solution by automatically implementing bias correction
using the empirical quantile mapping method. This process allows us to
correct for discrepancies between observed data and model outputs. Note
that CAVAanalytics allows the selection of three bias-correction
methods.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># bias correction is applied with the widely used empirical quantile method</span></span>
<span><span class="va">proj_kenya_35bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projections.html">projections</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, bias.correction <span class="op">=</span> <span class="cn">T</span>, uppert<span class="op">=</span><span class="fl">35</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya_35bc</span>, ensemble<span class="op">=</span><span class="cn">T</span>,  </span>
<span>plot_titles <span class="op">=</span> <span class="st">"N &gt; 35 bc"</span>, </span>
<span>palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"darkred"</span><span class="op">)</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-16-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The results can also be visualized for the annual time series (data
is spatially aggregated).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya_35bc</span>, ensemble<span class="op">=</span><span class="cn">T</span>,  </span>
<span>plot_titles <span class="op">=</span> <span class="st">"N &gt; 35 bc"</span>, temporal<span class="op">=</span><span class="cn">T</span>, palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;"></p>
<p>and without spatial or temporal aggregation. In this case we are
looking at the frequency distribution of the yearly data across all
pixels</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">proj_kenya_35bc</span>, ensemble<span class="op">=</span><span class="cn">T</span>,  </span>
<span>plot_titles <span class="op">=</span> <span class="st">"N &gt; 35 bc"</span>, spatiotemporal<span class="op">=</span><span class="cn">T</span>, palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-18-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="climate-change-signal">Climate change signal<a class="anchor" aria-label="anchor" href="#climate-change-signal"></a>
</h2>
<p>While analyzing future periods can be useful, more often we
prioritize understanding delta changes, which represent the relative
increase or decrease in mean maximum temperatures compared to a
baseline. CAVAanalytics facilitates this analysis as well.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ccs_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">ccs_kenya</span>, ensemble<span class="op">=</span><span class="cn">F</span>, plot_titles <span class="op">=</span> <span class="st">"Δ °C"</span>, </span>
<span>legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"cyan"</span>, <span class="st">"green"</span>, <span class="st">"white"</span>, <span class="st">"yellow"</span> ,<span class="st">"orange"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-19-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="climate-change-signal-1">Climate change signal<a class="anchor" aria-label="anchor" href="#climate-change-signal-1"></a>
</h2>
<p>While analyzing future periods can be useful, more often we
prioritize understanding delta changes, which represent the relative
increase or decrease in mean maximum temperatures compared to a
baseline. CAVAanalytics facilitates this analysis as well.</p>
<p>To notice that the function climate_change_signal also calculates the
agreement in the sign of the change. Basically, with a threshold of 0.8,
it means that if 80% of the models agree that the climate change signal
is positive or negative, the pixel gets a score of 1. These results are
visualized through a black dot.</p>
<p>When working with precipitation, it can be useful to look at the
results in percentages. This can be done easily by specifying percentage
as TRUE in climate_change_signal</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ccs_kenya</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, threshold <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">ccs_kenya</span>, plot_titles <span class="op">=</span> <span class="st">"Δ °C"</span>, </span>
<span>legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-20-1.png" width="960"></p>
<p>Anomalies can also be visualized for the annual time series</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">ccs_kenya</span>, plot_titles <span class="op">=</span> <span class="st">"Annual Δ (°C)"</span>, temporal<span class="op">=</span><span class="cn">T</span>, palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-21-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="customise-plot-apperances">Customise plot apperances<a class="anchor" aria-label="anchor" href="#customise-plot-apperances"></a>
</h2>
<p>CAVAanalytics also offer some easy to use function to modify plot
appearances. For example, we can remove all facet text from the ggplot
object</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">ccs_kenya</span>, plot_titles <span class="op">=</span> <span class="st">"Δ °C"</span>, </span>
<span>legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, point_size<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="../reference/remove_facets.html">remove_facets</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span> <span class="co"># remove facet text</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-22-1.png" width="960"></p>
<p>We can also produce more complex plots, for example we can look at
two time frames</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># subset model projections years</span></span>
<span><span class="va">kenya_exmp_2030_2040</span><span class="op">=</span> <span class="fu"><a href="../reference/years_selection.html">years_selection</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, years <span class="op">=</span> <span class="fl">2030</span><span class="op">:</span><span class="fl">2040</span>, projections <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">kenya_exmp_2040_2050</span><span class="op">=</span> <span class="fu"><a href="../reference/years_selection.html">years_selection</a></span><span class="op">(</span><span class="va">kenya_exmp</span>, years <span class="op">=</span> <span class="fl">2040</span><span class="op">:</span><span class="fl">2050</span>, projections <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate climate change signal for thw two time frames</span></span>
<span><span class="va">ccs_kenya_2030_2040</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">kenya_exmp_2030_2040</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, threshold <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">ccs_kenya_2040_2050</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">kenya_exmp_2040_2050</span>, season<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, threshold <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make first plot, rename facet label</span></span>
<span><span class="va">p1</span><span class="op">=</span> <span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">ccs_kenya_2030_2040</span>, plot_titles <span class="op">=</span> <span class="st">"Δ °C"</span>, </span>
<span>legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, point_size<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="../reference/rename_facets.html">rename_facets</a></span><span class="op">(</span>current_label <span class="op">=</span> <span class="st">"JFMAMJJASOND"</span>, new_label <span class="op">=</span> <span class="st">"2030-2040"</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="../reference/remove_facets.html">remove_facets</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make second plot, rename facet label</span></span>
<span><span class="va">p2</span><span class="op">=</span> <span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">ccs_kenya_2040_2050</span>, plot_titles <span class="op">=</span> <span class="st">"Δ °C"</span>, </span>
<span>legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"tmp"</span>, divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, point_size<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="../reference/rename_facets.html">rename_facets</a></span><span class="op">(</span>current_label <span class="op">=</span> <span class="st">"JFMAMJJASOND"</span>, new_label <span class="op">=</span> <span class="st">"2040-2050"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine the plots and collect the legend. You need to have patchwork installed first </span></span>
<span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">+</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-23-1.png" width="480"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Riccardo Soldan, Rodrigo Manzanas, Ana Casanueva.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
