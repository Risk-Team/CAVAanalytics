<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis of CMIP6 Models using CAVAanalytics • CAVAanalytics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of CMIP6 Models using CAVAanalytics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CAVAanalytics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/CAVA.html"><span class="fa fas fa-cloud-sun-rain"></span> CAVA vs other tools</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/more_advanced.html">Climate indexes</a></li>
    <li><a class="dropdown-item" href="../articles/large_areas.html">Computation over large regions</a></li>
    <li><a class="dropdown-item" href="../articles/own_data.html">CAVAanalytics and CMIP6 models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Risk-team/CAVAanalytics/"><span class="fa fa-github fa-lg"></span> GitHub</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fas fa-history"></span> Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analysis of CMIP6 Models using CAVAanalytics</h1>
            
      

      <div class="d-none name"><code>own_data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://risk-team.github.io/CAVAanalytics/">CAVAanalytics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>CAVAanalytics is a versatile framework designed for the analysis and
visualization of gridded climate data. This document will guide you
through the process of handling CMIP6 model outputs, which have been
downscaled and bias-corrected using the ISIMIP methodology. The models
are accessible via <a href="https://www.isimip.org/" class="external-link">ISIMIP’s official
portal</a>.</p>
<div class="section level3">
<h3 id="downloading-cmip6-isimip-climate-datasets">Downloading CMIP6-ISIMIP climate datasets<a class="anchor" aria-label="anchor" href="#downloading-cmip6-isimip-climate-datasets"></a>
</h3>
<p>To facilitate the download of the necessary climate datasets, we have
prepared a convenient bash script. This script and its usage are
documented <a href="https://github.com/Risk-Team/ISIMIP" class="external-link">in our GitHub
repository</a>. Below is an example of how to execute the script:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>bash isimip.sh <span class="sc">-</span>m all <span class="sc">-</span>v pr <span class="sc">-</span>s all <span class="sc">-</span>x <span class="st">"32 41"</span> <span class="sc">-</span>y <span class="st">"-5 5"</span></span></code></pre></div>
<p>This script will download historical data and future scenarios
(ssp126 and ssp585) for five GCMs, and it will automatically generate
ncml files to merge individual NetCDF files.</p>
<p>Note: Windows users can enable the Windows Subsystem for Linux (WSL)
to run bash scripts natively.</p>
</div>
<div class="section level3">
<h3 id="processing-the-cmip6-isimip-climate-datasets-with-cavaanalytics">Processing the CMIP6-ISIMIP climate datasets with CAVAanalytics<a class="anchor" aria-label="anchor" href="#processing-the-cmip6-isimip-climate-datasets-with-cavaanalytics"></a>
</h3>
<p>Once the data is downloaded, it can be loaded into CAVAanalytics as
shown below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">isimip_data</span><span class="op">=</span> <span class="fu"><a href="../reference/load_data.html">load_data</a></span><span class="op">(</span>path.to.data <span class="op">=</span> <span class="st">"/home/riccardo/Downloads/isimip_kenya/ncml/"</span>, country <span class="op">=</span> <span class="st">"Kenya"</span>, variable <span class="op">=</span> <span class="st">"pr"</span>,</span>
<span>                       years.hist <span class="op">=</span> <span class="fl">1980</span><span class="op">:</span><span class="fl">2000</span>, years.proj <span class="op">=</span><span class="fl">2030</span><span class="op">:</span><span class="fl">2050</span>, path.to.obs <span class="op">=</span> <span class="st">"W5E5"</span><span class="op">)</span></span></code></pre></div>
<p>Note: Precipitation data should be converted from kg/m²/s to mm/day
by multiplying by 86400.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">isimip_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span> <span class="va">isimip_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>models_mbrs<span class="op">=</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">models_mbrs</span>, <span class="op">~</span> <span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/gridArithmetics.html" class="external-link">gridArithmetics</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">86400</span>, operator <span class="op">=</span> <span class="st">"*"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The following code snippet visualizes the mean cumulative
precipitation for the CMIP6 models</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/projections.html">projections</a></span><span class="op">(</span><span class="va">isimip_data</span>, season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">try</span>, plot_titles <span class="op">=</span> <span class="st">"mm"</span>, ensemble <span class="op">=</span> <span class="cn">F</span>, palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"pr"</span>, divergent <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/fig2_isimip.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="cordex-core-vs--cmip6-model-outputs">CORDEX-CORE vs. CMIP6 Model Outputs<a class="anchor" aria-label="anchor" href="#cordex-core-vs--cmip6-model-outputs"></a>
</h3>
<p>This section presents a quick comparison between the climate change
signals in mean total annual precipitation projected by the CMIP6 and
CORDEX-CORE ensembles for Kenya (<strong>for demonstration purposes
only</strong>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cordex_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_data.html">load_data</a></span><span class="op">(</span>path.to.data <span class="op">=</span> <span class="st">"CORDEX-CORE"</span>, country <span class="op">=</span> <span class="st">"Kenya"</span>, variable <span class="op">=</span> <span class="st">"pr"</span>, </span>
<span>                        years.proj <span class="op">=</span> <span class="fl">2030</span><span class="op">:</span><span class="fl">2050</span>, years.hist <span class="op">=</span> <span class="fl">1980</span><span class="op">:</span><span class="fl">2000</span>, domain <span class="op">=</span> <span class="st">"AFR-22"</span>, path.to.obs <span class="op">=</span> <span class="st">"W5E5"</span><span class="op">)</span></span></code></pre></div>
<p>The following figures provide a comparative visualization of the
projected changes</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">a</span><span class="op">=</span><span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">cordex_data</span> , season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, percentage <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">.</span>, palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"pr"</span>,divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,  plot_titles <span class="op">=</span> <span class="st">"%"</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"CORDEX-CORE"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a.tr</span><span class="op">=</span><span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">cordex_data</span> , season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, percentage <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">.</span>, plot_titles <span class="op">=</span> <span class="st">"%"</span>, palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>,temporal <span class="op">=</span> <span class="cn">T</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">110</span>,<span class="fl">110</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span><span class="op">=</span><span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">isimip_data</span>, season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, percentage <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span><span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">.</span>, palette <span class="op">=</span> <span class="fu"><a href="../reference/IPCC_palette.html">IPCC_palette</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"pr"</span>,divergent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, plot_titles <span class="op">=</span> <span class="st">"%"</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"CMIP6"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b.tr</span><span class="op">=</span><span class="fu"><a href="../reference/climate_change_signal.html">climate_change_signal</a></span><span class="op">(</span><span class="va">isimip_data</span> , season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, percentage <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/plotting.html">plotting</a></span><span class="op">(</span><span class="va">.</span>, plot_titles <span class="op">=</span> <span class="st">"%"</span>,palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, temporal <span class="op">=</span> <span class="cn">T</span>, legend_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">110</span>,<span class="fl">110</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                      linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>                      color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined</span><span class="op">=</span><span class="va">a</span><span class="op">+</span><span class="va">b</span><span class="op">+</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined</span><span class="op">/</span><span class="op">(</span><span class="va">a.tr</span><span class="op">+</span><span class="va">b.tr</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/fig3_isimip.png" width="100%" style="display: block; margin: auto;"></p>
<p>Initial analysis indicates a significant discrepancy in the climate
change signal for precipitation between the two data sets. The
CMIP6-ISIMIP ensemble shows a positive climate change signal for
precipitation compared to the CORDEX-CORE ensemble.</p>
<p><strong>CORDEX-CORE Models</strong>: These models potentially provide
better resolution of <a href="https://journals.ametsoc.org/view/journals/clim/26/21/jcli-d-12-00708.1.xml" class="external-link">large-scale
phenomena impacts</a> and spatial variability.</p>
<p><strong>ISIMIP CMIP6 Data</strong>: This dataset is not dynamically
downscaled, possibly leading to less precise representation of local
spatial precipitation patterns compared to CORDEX-CORE under these
circumstances.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Riccardo Soldan, Rodrigo Manzanas, Ana Casanueva.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
