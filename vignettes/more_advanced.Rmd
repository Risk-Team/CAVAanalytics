---
title: "Climate indexes and composite plots"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, message=F, warning=FALSE}
library(CAVAanalytics)
library(patchwork)
library(ggplot2)
library(magrittr)
```

In the [getting started article](https://risk-team.github.io/CAVAanalytics/articles/Introduction.html), we have already explored some of the fundamental features of CAVAanalytics. Now, let's take our understanding to the next level as we delve into the full potential of CAVAanalytics.



```{r, message=F, warning=F}
# to download a specific area, set country=NULL and specify xlim and ylim arguments. 
kenya_exmp <- load_data(path.to.data = "CORDEX-CORE", country = "Kenya", variable = "tasmax", 
                        years.proj = 2030:2060, years.hist = NULL, domain = "AFR-22")



```

## Composite seasonal plot
Creating plots for multiple seasons is very easy with CAVAanalytics. Simply specify season=list(1:3, 4:6), for example. 

```{r,  warning=F, message=FALSE, fig.height=5, fig.width=6}

projections(kenya_exmp, season = list(1:3, 4:6, 7:9,10:12)) %>%
  plotting(., plot_titles = "mean tasmax Â°C", ensemble = T)

```

## Climate indicators

What if we want to understand the projected duration of heat waves **with at least 3 consecutive days** with temperature above 35 degrees. This can be done as follow. This can be done by specifying the threshold (uppert), with consecutive = TRUE and duration=4.
Remember to type ?projections if you have any doubts about what each argument does.

```{r,  warning=F, message=FALSE, fig.height=5, fig.width=6}

projections(kenya_exmp, season = list(1:3,4:6,7:9, 10:12), consecutive=T, duration=3, uppert=35) %>%
  plotting(., plot_titles = "N.days", ensemble = T, palette = c("white", "orange", "red", "darkred", "brown"))

```

As always you can also look at the individual models

```{r,  warning=F, message=FALSE, fig.height=7, fig.width=15}

projections(kenya_exmp, season = list(1:3,4:6,7:9, 10:12), consecutive=T, duration=3, uppert=35) %>%
  plotting(., plot_titles = "N.days", ensemble = F, palette = c("white", "orange", "red", "darkred", "brown"))

```


The same concept applies to all other functions available in CAVAanalytics step 2. 
